define(["require","exports","module","famous/core/View","famous/core/Surface","famous/core/Transform","famous/modifiers/StateModifier","famous/transitions/Easing","famous/surfaces/ContainerSurface","famous/surfaces/ImageSurface","famous/modifiers/Draggable","famous/inputs/MouseSync","famous/utilities/Timer","famous/transitions/Transitionable","famous/core/Modifier"],function(e,i,t){function o(e,i,t){l.apply(this,arguments),this.boardViewRef=e,this.minimumColumnWidth=this.boardViewRef.minimumColumnWidth,this.windowWidth=i,this.windowHeight=t,this.rootModifier=new c({size:this.options.size,origin:[0,0],align:[0,0]}),this.myTimer,this.dragTimer,this.handleSize=[this.boardViewRef.options.gutter+2,window.innerHeight],this.handleSizeLarge=[this.boardViewRef.options.gutter+20,window.innerHeight],this.mainNode=this.add(this.rootModifier),n.call(this)}function n(){var e=this;this.leftHandleStartPosition=this.boardViewRef.options.columnWidths[0]*this.windowWidth,this.leftHandleAbsolutePosition=this.boardViewRef.options.columnWidths[0]*this.windowWidth,this.leftHandle=d.call(this),this.leftHandleModifier=new c({align:[0,0],origin:[.5,0],transform:u.translate(this.leftHandleStartPosition,0,0)});var i=0-this.leftHandleStartPosition+this.minimumColumnWidth,t=window.innerWidth-this.leftHandleAbsolutePosition-this.minimumColumnWidth;this.leftHandleDraggable=new g({snapX:5,xRange:[i,t],yRange:[0,0]}),this.leftHandleDraggable.subscribe(this.leftHandle),this.mainNode.add(this.leftHandleDraggable).add(this.leftHandleModifier).add(this.leftHandle),this.leftHandleDraggable.on("start",function(){a(e)}),this.leftHandleDraggable.on("end",function(){r(e)}),this.leftHandleDraggable.on("update",function(){}),window.handles=[this.leftHandle]}function a(e){e.boardViewRef.handlesActive=!0,e.boardViewRef.disableScrollSurfaces(),this.dragTimer=b.setInterval(function(){var i=e.leftHandleDraggable.getPosition();e.leftHandleAbsolutePosition=e.leftHandleStartPosition+i[0],s(e,e.leftHandleStartPosition+i[0])},25)}function r(e){b.clear(this.dragTimer),this.dragTimer=null,e.leftHandle.removeHandle();var i=e.leftHandleDraggable.getPosition();e.leftHandleAbsolutePosition=e.leftHandleStartPosition+i[0],s(e,e.leftHandleStartPosition+i[0]),e.boardViewRef.enableScrollSurfaces();for(var t=0;t<e.boardViewRef.columnCount;t++)e.boardViewRef.columns[t].snap();e.boardViewRef.handlesActive=!1}function s(e,i){e.leftHandleAbsolutePosition=i,e.boardViewRef.coloumnModifiers[0].sizeFrom([i,void 0]);var t;t=e.boardViewRef.windowHeight>i*e.boardViewRef.widthToHeightRatio?i*e.boardViewRef.widthToHeightRatio:e.boardViewRef.windowHeight,i*e.boardViewRef.widthToHeightRatio<e.boardViewRef.windowHeight/2&&(t=e.boardViewRef.windowHeight/2),e.boardViewRef.columns[0].resizeItems([i,t],e.boardViewRef.widthToHeightRatio);var o,n=window.innerWidth-i;o=e.boardViewRef.windowHeight>n*e.boardViewRef.widthToHeightRatio?n*e.boardViewRef.widthToHeightRatio:e.boardViewRef.windowHeight,n*e.boardViewRef.widthToHeightRatio<e.boardViewRef.windowHeight/2&&(o=e.boardViewRef.windowHeight/2),e.boardViewRef.coloumnModifiers[1].sizeFrom([n,void 0]),e.boardViewRef.coloumnModifiers[1].setTransform(u.translate(i,0,0)),e.boardViewRef.columns[1].resizeItems([n,o],e.boardViewRef.widthToHeightRatio)}function d(){var e,i=this,t=new H(0);e=window.hudStart&&!WURFL.is_mobile?["scroll-surface-blur"]:["scroll-surface"];var o,n=new m({origin:[.5,.5],align:[.5,.5],classes:e,size:i.handleSize,properties:{color:"#fff",cursor:"col-resize",zIndex:0}}),a=new f({size:i.handleSize,origin:[.5,0],properties:{backgroundColor:"#333",color:"#fff",cursor:"col-resize",zIndex:0,pointerEvents:"none"}}),r=new p({origin:[.5,.5],align:[.5,.5],transform:function(){return u.translate(0,0,1)}}),s=new f({size:i.handleSize,origin:[.5,0],opacity:0,properties:{backgroundColor:"#666",zIndex:0,pointerEvents:"none"}}),d=new p({origin:[.5,.5],align:[.5,.5],transform:function(){return u.translate(0,0,2)},opacity:function(){return t.get()}}),l=[];if(WURFL.is_mobile){var o="images/left_right_wide.png";l=[86,34]}else{var o="images/left_right.png";l=[72,34]}var c=new w({content:o,size:[l[0],l[1]],properties:{pointerEvents:"all",zIndex:0}}),g=new p({align:[.5,.45],origin:[.5,.5],transform:function(){var e=t.get();return u.scale(e,e,1)}});n.add(r).add(a),n.add(d).add(s),n.add(g).add(c);var R,v=!1;return n.removeHandle=function(){a.setProperties({backgroundColor:"#333"}),b.clear(R),v=!1,R=b.setTimeout(function(){t.set(0,{duration:500,curve:h.outBounce})},300)},n.makeHandleSurfaceGreen=function(){a.setProperties({backgroundColor:"#666"})},n.makeHandleSurfaceGrey=function(){a.setProperties({backgroundColor:"#333333"})},window.debug?(n.on("mouseenter",function(e){b.clear(R),t.set(1,{duration:500,curve:h.outBounce})}),n.on("mouseleave",function(e){b.clear(R),R=b.setTimeout(function(){t.set(0,{duration:500,curve:h.outBounce})},300)})):WURFL.is_mobile?(n.on("touchstart",function(e){b.clear(R),t.set(1,{duration:500,curve:h.outBounce})}),n.on("touchend",function(e){b.clear(R),R=b.setTimeout(function(){t.set(0,{duration:500,curve:h.outBounce})},300)})):(n.on("mousedown",function(e){t.set(1),v=!0}),n.on("mouseover",function(e){0==v&&(b.clear(R),t.set(1,{duration:500,curve:h.outBounce}))}),n.on("mouseout",function(e){b.clear(R),0==v&&(b.clear(R),R=b.setTimeout(function(){t.set(0,{duration:500,curve:h.outBounce})},300))})),n}var l=e("famous/core/View"),f=e("famous/core/Surface"),u=e("famous/core/Transform"),c=e("famous/modifiers/StateModifier"),h=e("famous/transitions/Easing"),m=e("famous/surfaces/ContainerSurface"),w=e("famous/surfaces/ImageSurface"),g=e("famous/modifiers/Draggable"),b=(e("famous/inputs/MouseSync"),e("famous/utilities/Timer")),H=e("famous/transitions/Transitionable"),p=e("famous/core/Modifier");o.prototype=Object.create(l.prototype),o.prototype.constructor=o,o.DEFAULT_OPTIONS={},t.exports=o,o.prototype.getHandlePosition=function(e){var i;switch(e){case 0:i=this.leftHandleAbsolutePosition}return i},o.prototype.getHandleLeftLimit=function(e){var i;switch(e){case 0:i=0+this.minimumColumnWidth}return i},o.prototype.getHandleRightLimit=function(e){var i;switch(e){case 0:i=this.boardViewRef.windowWidth-this.minimumColumnWidth}return i},o.prototype.moveHandle=function(e,i){var t=i-this.leftHandleStartPosition,o=this,n=function(){var e=o.leftHandleDraggable.getPosition(),i=o.leftHandleStartPosition+e[0];s(o,i)},a=function(){o.boardViewRef.columns[0].snap(),o.boardViewRef.columns[1].snap()};switch(e){case 0:this.leftHandle.removeHandle(),this.leftHandle.makeHandleSurfaceGreen(),this.leftHandleAbsolutePosition=i,this.myTimer=b.setInterval(n,20),this.leftHandleDraggable.setPosition([t,0,0],{curve:h.outCirc,duration:1e3},function(){o.leftHandle.makeHandleSurfaceGrey(),s(o,i),b.clear(o.myTimer),b.setTimeout(a,100)})}},o.prototype.disableHandleSurfaces=function(){this.leftHandle.setProperties({pointerEvents:"none"})},o.prototype.enableHandleSurfaces=function(){this.leftHandle.setProperties({pointerEvents:"all"})}});